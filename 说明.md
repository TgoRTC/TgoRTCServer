# ğŸš€ LiveKit éƒ¨ç½²è„šæœ¬

> ç»Ÿä¸€çš„ LiveKit éƒ¨ç½²å·¥å…·ï¼Œæ”¯æŒå•æœºå’Œåˆ†å¸ƒå¼éƒ¨ç½²

---

## ğŸ“‹ æ–‡ä»¶è¯´æ˜

### è„šæœ¬æ–‡ä»¶ï¼ˆ4 ä¸ªï¼‰
- **deploy.sh** - ç»Ÿä¸€éƒ¨ç½²è„šæœ¬ï¼ˆè‡ªåŠ¨æ£€æµ‹å•æœº/åˆ†å¸ƒå¼ï¼‰
- **monitor-livekit.sh** - ç›‘æ§å’Œç»´æŠ¤å·¥å…·
- **troubleshoot-livekit.sh** - æ•…éšœè¯Šæ–­å·¥å…·

### é…ç½®æ–‡ä»¶ï¼ˆ1 ä¸ªï¼‰
- **.env.example** - ç¯å¢ƒé…ç½®æ¨¡æ¿

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å‡†å¤‡
```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x *.sh

# å¤åˆ¶é…ç½®æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘é…ç½®ï¼ˆä¿®æ”¹ DOMAIN ä¸ºä½ çš„åŸŸåï¼‰
nano .env
```

### 2. é…ç½®éƒ¨ç½²æ–¹å¼

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œä¿®æ”¹ `NODES` é…ç½®ï¼š

**å•æœºéƒ¨ç½²**
```bash
NODES=localhost
```

**åˆ†å¸ƒå¼éƒ¨ç½²ï¼ˆ3 ä¸ªèŠ‚ç‚¹ï¼‰**
```bash
NODES=192.168.1.10,192.168.1.11,192.168.1.12
```

### 3. éƒ¨ç½²
```bash
./deploy.sh deploy
```

### 4. éªŒè¯
```bash
./monitor-livekit.sh status
```

---

## ğŸ“– å¸¸ç”¨å‘½ä»¤

### éƒ¨ç½²ç®¡ç†
```bash
./deploy.sh deploy              # éƒ¨ç½²
./deploy.sh start               # å¯åŠ¨
./deploy.sh stop                # åœæ­¢
./deploy.sh restart             # é‡å¯
./deploy.sh backup              # å¤‡ä»½
./deploy.sh restore /path/to/backup  # æ¢å¤
./deploy.sh verify              # éªŒè¯éƒ¨ç½²
```

### ç›‘æ§
```bash
./monitor-livekit.sh status     # çŠ¶æ€æ£€æŸ¥
./monitor-livekit.sh logs livekit  # æŸ¥çœ‹æ—¥å¿—
./monitor-livekit.sh resources  # èµ„æºç›‘æ§
```

### æ•…éšœæ’æŸ¥
```bash
./troubleshoot-livekit.sh full  # å®Œæ•´è¯Šæ–­
./troubleshoot-livekit.sh report  # ç”ŸæˆæŠ¥å‘Š
```

---

## âš™ï¸ é…ç½®è¯´æ˜

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå…³é”®é…ç½®é¡¹ï¼š

```bash
# éƒ¨ç½²æ¨¡å¼ï¼šsingle æˆ– multi-node
DEPLOYMENT_MODE=single

# ä½ çš„åŸŸå
DOMAIN=livekit.example.com

# Redis å¯†ç 
REDIS_PASSWORD=your_password

# æ•°æ®ç›®å½•
DATA_DIR=/data/livekit
BACKUP_DIR=/data/backups
```

---

## ğŸ”’ é˜²ç«å¢™é…ç½®

### Ubuntu/Debian (UFW)
```bash
sudo ufw enable
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 7880/tcp
sudo ufw allow 7881/tcp
sudo ufw allow 7882/tcp
sudo ufw allow 3478/tcp
sudo ufw allow 3478/udp
sudo ufw allow 50000:60000/udp
```

### CentOS/RHEL (Firewalld)
```bash
sudo systemctl start firewalld
sudo firewall-cmd --permanent --add-port=22/tcp
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --permanent --add-port=443/tcp
sudo firewall-cmd --permanent --add-port=7880/tcp
sudo firewall-cmd --permanent --add-port=7881/tcp
sudo firewall-cmd --permanent --add-port=7882/tcp
sudo firewall-cmd --permanent --add-port=3478/tcp
sudo firewall-cmd --permanent --add-port=3478/udp
sudo firewall-cmd --permanent --add-port=50000-60000/udp
sudo firewall-cmd --reload
```

---

## ğŸ”„ ä»å•æœºå‡çº§åˆ°åˆ†å¸ƒå¼

å¦‚æœä½ å·²ç»éƒ¨ç½²äº†å•æœºç‰ˆæœ¬ï¼Œå¯ä»¥è½»æ¾å‡çº§åˆ°åˆ†å¸ƒå¼éƒ¨ç½²ï¼š

```bash
# 1. å¤‡ä»½å½“å‰æ•°æ®
./deploy.sh backup

# 2. ä¿®æ”¹ .env æ–‡ä»¶ä¸­çš„ NODES é…ç½®
# ä» NODES=localhost
# æ”¹ä¸º NODES=192.168.1.10,192.168.1.11,192.168.1.12

# 3. é‡æ–°éƒ¨ç½²
./deploy.sh deploy

# 4. éªŒè¯éƒ¨ç½²
./deploy.sh verify
```

**å‡çº§ä¼˜åŠ¿ï¼š**
- ğŸ”„ è´Ÿè½½å‡è¡¡ - æµé‡åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹
- ğŸ“ˆ é«˜å¯ç”¨æ€§ - å•ä¸ªèŠ‚ç‚¹æ•…éšœä¸å½±å“æœåŠ¡
- ğŸš€ æ›´å¥½çš„æ€§èƒ½ - æ”¯æŒ 3 å€çš„å¹¶å‘è¿æ¥
- ğŸ”§ çµæ´»æ‰©å±• - å¯ä»¥è½»æ¾æ·»åŠ æ›´å¤šèŠ‚ç‚¹

---

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- **CPU**: 2+ æ ¸ï¼ˆæ¨è 4+ æ ¸ï¼‰
- **å†…å­˜**: 4+ GBï¼ˆæ¨è 8+ GBï¼‰
- **å­˜å‚¨**: 20+ GB SSDï¼ˆæ¨è 50+ GBï¼‰
- **OS**: Ubuntu 20.04+ / CentOS 8+ / Debian 11+
- **Docker**: 20.10+
- **Docker Compose**: 1.29+

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Docker æœªå®‰è£…
```bash
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
```

### ç«¯å£è¢«å ç”¨
```bash
sudo netstat -tlnp | grep 7880
sudo lsof -i :7880
```

### DNS è§£æå¤±è´¥
```bash
nslookup your_domain.com
dig your_domain.com
```

### æŸ¥çœ‹æ—¥å¿—
```bash
docker logs livekit
docker logs redis
docker logs caddy
```

---

## ğŸ“ è·å–å¸®åŠ©

```bash
# æŸ¥çœ‹è„šæœ¬å¸®åŠ©
./deploy-livekit.sh help
./monitor-livekit.sh help
./troubleshoot-livekit.sh help

# è¿è¡Œè¯Šæ–­
./troubleshoot-livekit.sh full
```

---

## â“ å¸¸è§é—®é¢˜

### éƒ¨ç½²ç›¸å…³é—®é¢˜
æŸ¥çœ‹ **DEPLOYMENT-FAQ.md**ï¼š
- âœ… å•æœºç‰ˆæœ¬æ˜¯å¦éœ€è¦ Redisï¼Ÿ
- âœ… å¦‚ä½•ä»å•æœºå‡çº§åˆ°åˆ†å¸ƒå¼ï¼Ÿ
- âœ… åˆ†å¸ƒå¼éƒ¨ç½²å¦‚ä½•åœ¨å¤šå°æœºå™¨ä¸Šæ‰§è¡Œï¼Ÿ
- âœ… Redis å¦‚ä½•é…ç½®ï¼Ÿ
- âœ… åˆ›å»ºæˆ¿é—´æ¥å£åº”è¯¥è¿”å›å“ªä¸ªåœ°å€ï¼Ÿ

### LiveKit URL é…ç½®
æŸ¥çœ‹ **LIVEKIT-URL-EXPLANATION.md**ï¼š
- âœ… LiveKitConfig ä¸­çš„ URL æ˜¯å“ªä¸ªåœ°å€ï¼Ÿ
- âœ… ä¸ºä»€ä¹ˆè¦è¿”å› Caddy åœ°å€è€Œä¸æ˜¯å…·ä½“çš„æœºå™¨ IPï¼Ÿ
- âœ… å¦‚ä½•é…ç½® LIVEKIT_URL ç¯å¢ƒå˜é‡ï¼Ÿ

---

**ç‰ˆæœ¬**: 2.0 | **æœ€åæ›´æ–°**: 2025å¹´10æœˆ23æ—¥

