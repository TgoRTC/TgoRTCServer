# LiveKit 部署环境配置文件
# 复制此文件为 .env 并根据需要修改
#
# 部署方式说明：
#   - 单机部署：在一台机器上部署，NODES 配置为该机器的 IP 或 localhost
#   - 分布式部署：在多台机器上部署，NODES 配置为所有机器的 IP 列表
#
# 示例：
#   单机：NODES=localhost
#   分布式：NODES=192.168.1.10,192.168.1.11,192.168.1.12

################################################################################
# 基本配置
################################################################################

# 域名（必需）
DOMAIN=livekit.example.com

# 部署目录
DEPLOYMENT_DIR=./livekit-deployment

# LiveKit 节点列表（逗号分隔的 IP 地址或主机名）
# 单机部署（内置 LiveKit）：留空或注释掉此行
# 集群部署（远程 LiveKit）：192.168.1.2:7880,192.168.1.3:7880,192.168.1.4:7880
# 如果为空，将使用内置的 LiveKit 服务
LIVEKIT_NODES=

################################################################################
# API 配置
################################################################################

# API 密钥（如果为空，脚本会自动生成）
LIVEKIT_API_KEY=

# API 密钥密码（如果为空，脚本会自动生成）
LIVEKIT_API_SECRET=

################################################################################
# Redis 配置
################################################################################

# Redis 主机
# 单机模式：redis（Docker 容器名）
# 集群模式：192.168.1.5（外部 Redis 服务器 IP）
REDIS_HOST=redis

# Redis 端口
REDIS_PORT=6379

# Redis 密码（可选）
REDIS_PASSWORD=

# Redis 数据库编号
REDIS_DB=0

# Redis 最大内存
REDIS_MAXMEMORY=2gb

# Redis 内存淘汰策略
REDIS_MAXMEMORY_POLICY=allkeys-lru

################################################################################
# LiveKit 服务器配置
################################################################################

# 监听端口
LIVEKIT_PORT=7880

# 绑定地址
LIVEKIT_BIND_ADDRESS=0.0.0.0

# 开发模式（true/false）
LIVEKIT_DEVELOPMENT=false

# 日志级别: debug, info, warn, error
LIVEKIT_LOG_LEVEL=info

# 房间自动创建
LIVEKIT_AUTO_CREATE_ROOM=true

# 空房间超时时间（秒）
LIVEKIT_EMPTY_TIMEOUT=300

# 最大参与者数（0 表示无限制）
LIVEKIT_MAX_PARTICIPANTS=0

# 邀请超时时间（秒）
LIVEKIT_TIMEOUT=3600

# LiveKit URL 配置
# LIVEKIT_URL: 后端调用 LiveKit API 的地址（内部网络地址）
# LIVEKIT_CLIENT_URL: 前端连接 LiveKit 的地址（公网地址或域名）
#
# 示例 1 - 单机部署（LiveKit 在同一 docker-compose 中）：
#   LIVEKIT_URL=http://livekit:7880
#   LIVEKIT_CLIENT_URL=http://your-domain.com:7880
#
# 示例 2 - 集群部署（通过 Nginx 负载均衡）：
#   LIVEKIT_URL=http://nginx:80
#   LIVEKIT_CLIENT_URL=https://your-domain.com
#
# 示例 3 - 使用 LiveKit Cloud：
#   LIVEKIT_URL=wss://your-project.livekit.cloud
#   LIVEKIT_CLIENT_URL=wss://your-project.livekit.cloud
#
# 注意：如果不设置 LIVEKIT_CLIENT_URL，将默认使用 LIVEKIT_URL
LIVEKIT_URL=http://livekit:7880
LIVEKIT_CLIENT_URL=

################################################################################
# API 服务配置
################################################################################

# 参与者超时检查间隔（秒）
PARTICIPANT_TIMEOUT_CHECK_INTERVAL=10

################################################################################
# TURN 服务器配置
################################################################################

# 启用 TURN
TURN_ENABLED=true

# TURN 域名
TURN_DOMAIN=${DOMAIN}

# TURN 外部 TLS 端口
TURN_EXTERNAL_TLS_PORT=443

# TURN 外部 UDP 端口
TURN_EXTERNAL_UDP_PORT=3478

################################################################################
# Nginx 配置
################################################################################

# Nginx 管理员邮箱（用于 Let's Encrypt 证书）
NGINX_ADMIN_EMAIL=admin@${DOMAIN}

# Nginx 日志级别
NGINX_LOG_LEVEL=info

################################################################################
# Docker 配置
################################################################################

# Docker 镜像版本
LIVEKIT_IMAGE_VERSION=latest

# Redis 镜像版本
REDIS_IMAGE_VERSION=7-alpine

# Nginx 镜像版本
NGINX_IMAGE_VERSION=alpine

# Certbot 镜像版本
CERTBOT_IMAGE_VERSION=latest

# Docker 网络名称
DOCKER_NETWORK_NAME=livekit



################################################################################
# 备份配置
################################################################################

# 备份目录
BACKUP_DIR=./livekit-deployment/backups

# 自动备份间隔（小时）
AUTO_BACKUP_INTERVAL=24

# 保留备份数量
BACKUP_RETENTION_COUNT=7

################################################################################
# 监控配置
################################################################################

# 启用监控
MONITORING_ENABLED=true

# 监控间隔（秒）
MONITORING_INTERVAL=60

# 日志保留天数
LOG_RETENTION_DAYS=30

################################################################################
# 性能调优
################################################################################

# Goroutine 数量（0 表示自动）
NUM_GOROUTINES=0

# 使用外部 IP 作为候选地址
USE_EXTERNAL_IP_FOR_CANDIDATES=false

# TCP 连接数限制
NUM_TCP_CONNS=100

# UDP 连接数限制
NUM_UDP_CONNS=100

################################################################################
# 音频配置
################################################################################

# 音频采样率
AUDIO_FREQUENCY=48000

# 音频通道数
AUDIO_NUM_CHANNELS=2

# 每帧样本数
AUDIO_SAMPLES_PER_FRAME=960

################################################################################
# 视频配置
################################################################################

# 视频帧率
VIDEO_FRAMERATE=30

# 视频宽度
VIDEO_WIDTH=1280

# 视频高度
VIDEO_HEIGHT=720

################################################################################
# 业务 Webhook 配置（通知其他服务）
################################################################################

# 配置方式 1（推荐）：使用 JSON 格式配置多个端点，每个端点可以有独立的密钥和超时
# 格式: [{"url":"http://service-a.com/webhook","secret":"secret-a","timeout":10},{"url":"http://service-b.com/webhook","secret":"secret-b","timeout":30}]
# 字段说明:
#   - url: Webhook URL（必需）
#   - secret: 签名密钥（必需）
#   - timeout: 超时时间（秒，可选，默认使用 BUSINESS_WEBHOOK_TIMEOUT）
# 示例:
# BUSINESS_WEBHOOK_ENDPOINTS='[{"url":"http://localhost:9000/webhook","secret":"secret-key-1","timeout":10},{"url":"http://localhost:9001/webhook","secret":"secret-key-2","timeout":30}]'
BUSINESS_WEBHOOK_ENDPOINTS=

# 配置方式 2（向后兼容）：使用逗号分隔的 URLs + 共享密钥
# 注意：如果配置了 BUSINESS_WEBHOOK_ENDPOINTS，则会忽略此配置
# 业务 webhook URLs（支持多个地址，用逗号分隔；如果为空则不发送 webhook）
# 示例: http://localhost:9000/webhook,http://localhost:9001/webhook
BUSINESS_WEBHOOK_URLS=

# 业务 webhook 签名密钥（用于 HMAC-SHA256 签名）
# 注意：仅在使用 BUSINESS_WEBHOOK_URLS 时有效
BUSINESS_WEBHOOK_SECRET=your_webhook_secret

# 业务 webhook 请求超时时间（秒，默认 10 秒）
# 注意：
# - 使用新方式（BUSINESS_WEBHOOK_ENDPOINTS）时，此配置作为默认值
# - 如果端点配置中指定了 timeout，则使用端点的 timeout
# - 如果端点配置中未指定 timeout，则使用此全局默认值
BUSINESS_WEBHOOK_TIMEOUT=10

# 业务 webhook 日志清理配置
# 启用日志自动清理（true/false）
BUSINESS_WEBHOOK_LOG_CLEANUP_ENABLED=true

# 日志保留天数（默认 30 天）
BUSINESS_WEBHOOK_LOG_RETENTION_DAYS=30

# 日志清理间隔（秒，默认 86400 = 1 天）
BUSINESS_WEBHOOK_LOG_CLEANUP_INTERVAL=86400

################################################################################
# 邮件通知配置（可选）
################################################################################

# SMTP 服务器
SMTP_SERVER=

# SMTP 端口
SMTP_PORT=587

# SMTP 用户名
SMTP_USERNAME=

# SMTP 密码
SMTP_PASSWORD=

# 通知邮箱
NOTIFICATION_EMAIL=

################################################################################
# 其他配置
################################################################################

# 时区
TZ=UTC

# 语言
LANG=en_US.UTF-8

# 调试模式
DEBUG=false

